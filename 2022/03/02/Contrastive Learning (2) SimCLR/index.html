<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('http://yoursite.com').hostname,
    root: '/',
    scheme: 'Mist',
    version: '7.5.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="Contrastive Learning (2) SimCLR This article decribes an end-to-end framework for contrastive learning called SimCLR. Paper: Ting Chen, Simon Kornblith, Mohammad Norouzi, and Ge- offrey Hinton. A simp">
<meta name="keywords" content="Contrastive Learning">
<meta property="og:type" content="article">
<meta property="og:title" content="Contrastive Learning (2) SimCLR">
<meta property="og:url" content="http://yoursite.com/2022/03/02/Contrastive Learning (2) SimCLR/index.html">
<meta property="og:site_name" content="Xiaoqi">
<meta property="og:description" content="Contrastive Learning (2) SimCLR This article decribes an end-to-end framework for contrastive learning called SimCLR. Paper: Ting Chen, Simon Kornblith, Mohammad Norouzi, and Ge- offrey Hinton. A simp">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/2022/03/02/images/simCLR/image-20220303214612980.png">
<meta property="og:image" content="http://yoursite.com/2022/03/02/images/simCLR/image-20220303215722792.png">
<meta property="og:image" content="http://yoursite.com/2022/03/02/images/simCLR/simCLR_framework.jpg">
<meta property="og:image" content="http://yoursite.com/2022/03/02/images/simCLR/image-20220304210711632.png">
<meta property="og:image" content="http://yoursite.com/2022/03/02/images/simCLR/image-20220304212004448.png">
<meta property="og:image" content="http://yoursite.com/2022/03/02/images/simCLR/image-20220304215204326.png">
<meta property="og:image" content="http://yoursite.com/2022/03/02/images/simCLR/image-20220304220654776.png">
<meta property="og:updated_time" content="2022-03-04T14:41:41.842Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Contrastive Learning (2) SimCLR">
<meta name="twitter:description" content="Contrastive Learning (2) SimCLR This article decribes an end-to-end framework for contrastive learning called SimCLR. Paper: Ting Chen, Simon Kornblith, Mohammad Norouzi, and Ge- offrey Hinton. A simp">
<meta name="twitter:image" content="http://yoursite.com/2022/03/02/images/simCLR/image-20220303214612980.png">

<link rel="canonical" href="http://yoursite.com/2022/03/02/Contrastive Learning (2) SimCLR/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>Contrastive Learning (2) SimCLR | Xiaoqi</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Xiaoqi</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">Why always me?</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2022/03/02/Contrastive Learning (2) SimCLR/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="Xiaoqi Zhuang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiaoqi">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Contrastive Learning (2) SimCLR
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-03-02 22:41:42" itemprop="dateCreated datePublished" datetime="2022-03-02T22:41:42+08:00">2022-03-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-03-04 22:41:41" itemprop="dateModified" datetime="2022-03-04T22:41:41+08:00">2022-03-04</time>
              </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="contrastive-learning-2-simclr">Contrastive Learning (2) SimCLR</h1>
<p>This article decribes an end-to-end framework for contrastive learning called SimCLR.</p>
<p>Paper: Ting Chen, Simon Kornblith, Mohammad Norouzi, and Ge- offrey Hinton. A simple framework for contrastive learning of visual representations. <em>arXiv:2002.05709</em>, 2020. Updated version accessed at: https://arxiv.org/abs/2002.05709.</p>
<a id="more"></a>
<h2 id="bottleneck-of-past-work">Bottleneck of past work</h2>
<p>Although InstDisc which we talked in the last chapter proposed a nice pretext task which makes self-supervised learning seems possible in CV field, the accuracy/performance of InstDisc on image-net is not high, which means that the representation learning from InstDisc is not good.</p>
<p><img src="../images/simCLR/image-20220303214612980.png" alt="image-20220303214612980" style="zoom:50%;"></p>
<p>Unlike other CV papers that put network structure or images in Figure 1, Figure 1 in simCLR just want to tell people that how good performance simCLR is. Actually, as the name of the paper defines, this is a very simple framework, but it is the first time that unsupervised learning can beat the benchmark supervised model on image-net, which demonstrates the power and confidence of unsupervised learning.</p>
<h2 id="model-framework">Model Framework</h2>
<p><img src="../images/simCLR/image-20220303215722792.png" alt="image-20220303215722792" style="zoom:50%;"></p>
<p>If Figure 2 is hard to understand, here is a pipeline drawn by me.</p>
<p><img src="../images/simCLR/simCLR_framework.jpg" alt="simCLR_framework" style="zoom:50%;"></p>
<p>The difference from InstDisc to simCLR is that it straightly uses images in the same batch as negative sample instead of using memory bank. In this way, all image vectors are obtained from the same encoder every time, which naturally solves the problem of inconsistent feature distribution in InstDisc.</p>
<h2 id="model-insights">Model Insights</h2>
<blockquote>
<ol type="1">
<li>Composition of multiple data augmentation operations is crucial in defining the contrastive prediction tasks that yield effective representations. In addition, unsupervised contrastive learning benefits from stronger data augmentation than supervised learning.</li>
<li>Introducing a learnable nonlinear transformation between the representation and the contrastive loss substantially improves the quality of the learned representations.</li>
<li>Representation learning with contrastive cross entropy loss benefits from normalized embeddings and an appropriately adjusted temperature parameter.</li>
<li>Contrastive learning benefits from larger batch sizes and longer training compared to its supervised counterpart. Like supervised learning, contrastive learning benefits from deeper and wider networks.</li>
</ol>
</blockquote>
<p>These 4 insights are the most important essence of this paper. We will discuss in detail one by one.</p>
<h3 id="data-augmentation">Data augmentation</h3>
<p>The first insight demonstrates that data guamentation is an important condition for a successful training in contrastive learning.</p>
<p><img src="../images/simCLR/image-20220304210711632.png" alt="image-20220304210711632" style="zoom:50%;"></p>
<p>Figure 5 shows that the combination of <strong>random cropping and random color distortion</strong> is the best data augmentation for improving accuracy. This result makes almost all subsequent comparative learning work use this data augmentation strategy.</p>
<p>Moreover, it conjectures that:</p>
<blockquote>
<p>one serious issue when using only random cropping as data augmentation is that most patches from an image share a similar color distribution. Neural nets may exploit this shortcut to solve the predictive task. Therefore, it is critical to compose cropping with color distortion in order to learn generalizable features.</p>
</blockquote>
<p>The original paper shows very detailed augmentation strategy and experiment results to prove this point in chapter 3.1, 3.2.</p>
<h3 id="projection">Projection</h3>
<p><img src="../images/simCLR/image-20220304212004448.png" alt="image-20220304212004448" style="zoom:50%;"></p>
<p>Projection is just a single dense layer with ReLu and is used bewteen the output of encoder and the input of loss function. It can make the outputs of encoder smoother. The experiment results show that add a nonlinear projector(one dense layer + Relu) improves accuracy a lot.</p>
<blockquote>
<p>We observe that a nonlinear projection is better than a linear projection (+3%), and much better than no projection (&gt;10%).</p>
</blockquote>
<p>Another interesting result is that:</p>
<blockquote>
<p>Furthermore, even when nonlinear projection is used, the layer before the projection head, h, is still much better (&gt;10%) than the layer after, z = g(h), which shows that <em>the hidden layer before the projection head is a better representation than the layer after</em>.</p>
</blockquote>
<p>which means that projection is really usefull for contrastive learning.</p>
<h3 id="hyperparameters">Hyperparameters</h3>
<figure>
<img src="../images/simCLR/image-20220304215204326.png" alt="image-20220304215204326"><figcaption>image-20220304215204326</figcaption>
</figure>
<p>Table 5 shows that temperature <span class="math display">\[\tau\]</span> has a strong effect on accuracy. Also, if model is trained without l2 norm, it may overfit (much higher in contrastive acc but low acc in downstream tasks).</p>
<p>In conclusion, this part talks more about tricks. It proves that <span class="math inline">\(\tau\)</span> is an important hyper parameter and l2 norm help representation</p>
<p>learning.</p>
<p>Actually, this chapter in the paper also describes about the loss function. But I decided to dedicate a specialized article for all loss functions in contrastive learning. We will talk it in that article.</p>
<h3 id="huge-negative-samples">Huge negative samples</h3>
<p><img src="../images/simCLR/image-20220304220654776.png" alt="image-20220304220654776" style="zoom:50%;"></p>
<p>Figure 9 shows that the accuracy of simCLR increases significantly with the increase of batch size. Since the size of batch size is the size of negative samples, the paper says that a huge negative sample set is the key to improving the performance of contrastive learning.</p>
<p>However, if you use a batch size which is more than 1024 to train, it requires huge calculation recourses and many tricks to make it start training. Hence, simCLR is hard to preproduce by ourselves and hard to land in real scene.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Although simCLR almost can not be preproduced and landed, it proves many useful tricks and insights for contrastive learning. Hence, simCLR has a huge impact on follow-up research due to its easy framework and strong results.</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Contrastive-Learning/" rel="tag"># Contrastive Learning</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/02/28/Contrastive Learning (1) InstDisc/" rel="prev" title="Contrastive Learning (1) InstDisc">
      <i class="fa fa-chevron-left"></i> Contrastive Learning (1) InstDisc
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/03/05/Contrastive Learning (3) MoCo/" rel="next" title="Contrastive Learning (3) MoCo">
      Contrastive Learning (3) MoCo <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#contrastive-learning-2-simclr"><span class="nav-number">1.</span> <span class="nav-text">Contrastive Learning (2) SimCLR</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#bottleneck-of-past-work"><span class="nav-number">1.1.</span> <span class="nav-text">Bottleneck of past work</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#model-framework"><span class="nav-number">1.2.</span> <span class="nav-text">Model Framework</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#model-insights"><span class="nav-number">1.3.</span> <span class="nav-text">Model Insights</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#data-augmentation"><span class="nav-number">1.3.1.</span> <span class="nav-text">Data augmentation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#projection"><span class="nav-number">1.3.2.</span> <span class="nav-text">Projection</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hyperparameters"><span class="nav-number">1.3.3.</span> <span class="nav-text">Hyperparameters</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#huge-negative-samples"><span class="nav-number">1.3.4.</span> <span class="nav-text">Huge negative samples</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#conclusion"><span class="nav-number">1.4.</span> <span class="nav-text">Conclusion</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Xiaoqi Zhuang"
      src="/images/header.jpg">
  <p class="site-author-name" itemprop="name">Xiaoqi Zhuang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        


<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Xiaoqi Zhuang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://mist.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.5.0
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/muse.js"></script>
<script src="/js/next-boot.js"></script>

  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>
    <script defer src="/lib/three/canvas_lines.min.js"></script>
    <script defer src="/lib/three/canvas_sphere.min.js"></script>


  
















  

  

  

</body>

</html>
